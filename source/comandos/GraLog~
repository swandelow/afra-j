#!/bin/bash

#funcion que imprime el correcto uso de la herramienta
function printUsage {
	echo "wrong usage"
	echo "usage:"
	echo "GraLog <command name> <type> <message>"
	echo "type can be:"
	echo "INFO informative"
	echo "WAR warning"
	echo "ERROR error"
	
}

#asegura que tenga los tres parametros requeridos
if [ $# -ne 3 ]
then
	printUsage
	exit 1
fi

#asegura que el tipo del mensaje este entre los mensajes soportados
if [ $2 != "I" ] && [ $2 != "W" ] && [ $2 != "E" ] && [ $2 != "SE" ]
then
	printUsage
	exit 1
fi

#path de la carpeta de logueo
logPath="$grupo/comandos/log/"
message=$3
sizeLimit=1048576
filename="$1.log"
file="$logPath$filename"
type=$2
date=$(date)

#escribe en el archivo
echo "$date-$type-$message" >> "$file"

#obtiene el tamanio del archivo
filesize=$(stat -c%s "$file")

if [ $filesize -gt $sizeLimit ]
then
	echo "log $filename excedido"
fi

exit 0
